<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
	/*Create a table to store elements in receipt*/
	table {
		border-collapse: collapse;
		border-spacing: 0;
		width: 100%;
		border: 1px solid #ddd;
	}
	
	th, td {
		text-align: left;
		padding: 16px;
	}
	
	tr:nth-child(even) {
		background-color: #f2f2f2;
	}


	.receiptTotals {
		background-color: none;
		text-align: right;
	}
	
	.content {
		width: 100%;
		height: 90%;
	}

	#row {
		display: none;
	}
	
	/*Button group for creating the buttons at top of page*/
	/*Same button group from the main page*/
	.button-group button {
		background-color: #D3D3D3; /*Makes Gray background*/
		border:  1% #D3D3D3;  /*Border around boxes is Gray*/
		color: black; /* White text */
		padding: 10px 10px; /* Some padding */
		margin: 0;  /* Created space between buttons */
		font-family: Arial Black, Times, serif; /* sets font */
		font-size:  16px;	/* Sets size */
		font-weight:  normal;	/*Sets normal or bold */
		text-align: center;	/* Aligns to center of button */
		cursor: pointer; /* Pointer/hand icon */
		width: 35%; /* Set a width if needed */
		display: inline-block;
	}

	/* Add a background color on click */
	.button-group button:focus {
		background-color: green;
	}
	
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
	
	window.addEventListener('message', addReceipt, false);
	function addReceipt(message){
		var clone = $("#row").clone(true);
		clone.css('display','block'); 
		
		
		//Add an ajax request to items using _id.$oid
		var queryStr = window.location.search;
		var category = queryStr.substr(1)
		var url = 'http://159.89.238.181:8080/api/items?id=' + message.data.$oid;//.concat();
		console.log(url);
		$.get(url, message.data._id, function(response){
			
			clone.children("#item").html(JSON.parse(response).name);
			clone.children("#price").html(JSON.parse(response).price);
			clone.children("SubTot").load(function () {
				var item = $(this).price;
			})
		})
		
		clone.appendTo('#receipt');	
		
		/*
		$(function (){
		var subTotal = "0.00";
		var salesTx  = "0.08";
		var finalTotal = "0.00";
		$("#price").each(function(){
			subTotal = subTotal + parseFloat($(this).html());
		});
		//$("#SubTot").html("Subtotal= " subTotal.toString());
		printSubTotal(subTotal);
		salesTx *= subTotal;
		printSalesTax(salesTx);
		finalTotal = subTotal + (subTotal * salesTx);
		printFinalTotal(finalTotal);
		});*/
	}
	
	//Function to calculate the total of items in the receipt.
	
	
	function printSubTotal(subTotal){
		document.getElementById("SubTot").innerHtml = subTotal;
	}
	
	function printSalesTax(salesTx){
		document.getElementById("SlsTax").innerHtml = salesTx;
	}
	
	function printTip(tipAmnt){
		document.getElementById("Tip") = tipAmnt;
	}
	
	function printFinalTotal(finalTotal){
		document.getElementById("FinTot").innerHtml = finalTotal;
	}
	
	function submitCoupon(){
		document.getElementById("CouponCode").reset();
		
	}
	
</script>
</head>
<body style="background-color:white">
  <div class = "content">
	<!--Creating a table to store purchase information-->
  </div>
	<table id="receipt">
		<tr id="header">
			<td>Item</td>
			<td>Price</td>
		</tr>
		<tr id="row">
			<td id="item">some text</td>
			<th><th>
			<td id="price">some price</td>
		</tr>
	</table>
	
	<br>
	<form id="CouponCode">
		Add Couon Code: <input type="text" id="coupon" name="coupon"><br><br>
		<input type="button" value="Submit" onclick="submitCoupon()">
	</form>
	
	<table id="total">
		<tr>
			<th id="SubTot">Subtotal: </th><br>
		</tr>
		<tr>
			<th id="SlsTax">Tax: </th><br>
		</tr>
		<tr>
			<th id="tip">Gratuity: </th><br>
		</tr>
		<tr>
			<th id="FinTot">Total: </th><br>
		</tr>
	</table>
	
	<br>
	<div class="button-group">
			<button>Submit Payment</button>
	</div>
	
</body>
</html>

